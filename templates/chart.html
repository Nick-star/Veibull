{% extends 'base.html' %}

{% block content %}
    <div class="container">
        <h1 class="mt-4 mb-4">Диаграмма срока службы электролизера</h1>
        <label for="electrolyzer-select">Выберите электролизёр:</label>
        <select id="electrolyzer-select" multiple>
        </select>
        <div id="chart"></div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        {#let electrolyzers;#}
        {#let electrolyzerTypes;#}
        {##}
        $.getJSON("{% url 'get_electrolyzer_data' %}", function (response) {
            var weibullX = response.weibull.x;
            var weibullY = response.weibull.y;
            var empiricalX = response.empirical.x;
            var empiricalY = response.empirical.y;

            var trace1 = {
                x: weibullX,
                y: weibullY,
                mode: 'lines',
                name: 'Weibull',
                line: {
                    shape: 'spline'
                }
            };

            var trace2 = {
                x: empiricalX,
                y: empiricalY,
                mode: 'lines',
                name: 'Empirical',
                line: {
                    shape: 'spline'
                }
            };

            var data = [trace1, trace2];

            let layout = {
                title: 'CDF',
                xaxis: {title: 'Дни'},
                yaxis: {title: '%'}
            };

            Plotly.newPlot('chart', data, layout);
        })

        // Update chart when the selection changes
        {#$('#electrolyzer-select').on('change', updateChart);#}
    </script>
{% endblock %}
